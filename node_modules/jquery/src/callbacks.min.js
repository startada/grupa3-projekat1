define(["./core","./core/toType","./var/isFunction","./var/rnothtmlwhite"],function(d,c,e,a){function b(g){var f={};d.each(g.match(a)||[],function(i,h){f[h]=true});return f}d.Callbacks=function(o){o=typeof o==="string"?b(o):d.extend({},o);var j,h,f,i,m=[],k=[],l=-1,g=function(){i=i||o.once;f=j=true;for(;k.length;l=-1){h=k.shift();while(++l<m.length){if(m[l].apply(h[0],h[1])===false&&o.stopOnFalse){l=m.length;h=false}}}if(!o.memory){h=false}j=false;if(i){if(h){m=[]}else{m=""}}},n={add:function(){if(m){if(h&&!j){l=m.length-1;k.push(h)}(function p(q){d.each(q,function(s,r){if(e(r)){if(!o.unique||!n.has(r)){m.push(r)}}else{if(r&&r.length&&c(r)!=="string"){p(r)}}})})(arguments);if(h&&!j){g()}}return this},remove:function(){d.each(arguments,function(r,p){var q;while((q=d.inArray(p,m,q))>-1){m.splice(q,1);if(q<=l){l--}}});return this},has:function(p){return p?d.inArray(p,m)>-1:m.length>0},empty:function(){if(m){m=[]}return this},disable:function(){i=k=[];m=h="";return this},disabled:function(){return !m},lock:function(){i=k=[];if(!h&&!j){m=h=""}return this},locked:function(){return !!i},fireWith:function(q,p){if(!i){p=p||[];p=[q,p.slice?p.slice():p];k.push(p);if(!j){g()}}return this},fire:function(){n.fireWith(this,arguments);return this},fired:function(){return !!f}};return n};return d});