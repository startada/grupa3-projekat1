define(["../core","../var/indexOf","../var/isFunction","./var/rneedsContext","../selector"],function(b,a,c,e){function d(h,f,g){if(c(f)){return b.grep(h,function(k,j){return !!f.call(k,j,k)!==g})}if(f.nodeType){return b.grep(h,function(i){return(i===f)!==g})}if(typeof f!=="string"){return b.grep(h,function(i){return(a.call(f,i)>-1)!==g})}return b.filter(f,h,g)}b.filter=function(i,f,h){var g=f[0];if(h){i=":not("+i+")"}if(f.length===1&&g.nodeType===1){return b.find.matchesSelector(g,i)?[g]:[]}return b.find.matches(i,b.grep(f,function(j){return j.nodeType===1}))};b.fn.extend({find:function(g){var k,j,f=this.length,h=this;if(typeof g!=="string"){return this.pushStack(b(g).filter(function(){for(k=0;k<f;k++){if(b.contains(h[k],this)){return true}}}))}j=this.pushStack([]);for(k=0;k<f;k++){b.find(g,h[k],j)}return f>1?b.uniqueSort(j):j},filter:function(f){return this.pushStack(d(this,f||[],false))},not:function(f){return this.pushStack(d(this,f||[],true))},is:function(f){return !!d(this,typeof f==="string"&&e.test(f)?b(f):f||[],false).length}})});