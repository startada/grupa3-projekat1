define(["../core","../var/support","../ajax"],function(h,e){h.ajaxSettings.xhr=function(){try{return new window.XMLHttpRequest()}catch(a){}};var f={0:200,1223:204},g=h.ajaxSettings.xhr();e.cors=!!g&&("withCredentials" in g);e.ajax=g=!!g;h.ajaxTransport(function(b){var a,c;if(e.cors||g&&!b.crossDomain){return{send:function(d,p){var o,i=b.xhr();i.open(b.type,b.url,b.async,b.username,b.password);if(b.xhrFields){for(o in b.xhrFields){i[o]=b.xhrFields[o]}}if(b.mimeType&&i.overrideMimeType){i.overrideMimeType(b.mimeType)}if(!b.crossDomain&&!d["X-Requested-With"]){d["X-Requested-With"]="XMLHttpRequest"}for(o in d){i.setRequestHeader(o,d[o])}a=function(j){return function(){if(a){a=c=i.onload=i.onerror=i.onabort=i.ontimeout=i.onreadystatechange=null;if(j==="abort"){i.abort()}else{if(j==="error"){if(typeof i.status!=="number"){p(0,"error")}else{p(i.status,i.statusText)}}else{p(f[i.status]||i.status,i.statusText,(i.responseType||"text")!=="text"||typeof i.responseText!=="string"?{binary:i.response}:{text:i.responseText},i.getAllResponseHeaders())}}}}};i.onload=a();c=i.onerror=i.ontimeout=a("error");if(i.onabort!==undefined){i.onabort=c}else{i.onreadystatechange=function(){if(i.readyState===4){window.setTimeout(function(){if(a){c()}})}}}a=a("abort");try{i.send(b.hasContent&&b.data||null)}catch(n){if(a){throw n}}},abort:function(){if(a){a()}}}}})});